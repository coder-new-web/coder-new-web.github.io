import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as l,c,b as n,d as s,e as t,f as e}from"./app-af427ef1.js";const i="/assets/5_API-19e88aad.png",u="/assets/get-again-6f875dfe.png",r="/assets/team-dev-app-f387b8d5.png",d={},k=e(`<div class="hint-container danger"><p class="hint-container-title">错误信息</p><p>❌targetSdkVersion设置&gt;=29后在Android10+系统设备不支持当前路径。<br> 请更改为应用运行路径！</p></div><p>该问题出现场景是开发的uniapp在选取图片的时候，一些手机系统版本在选取图片的时候，勾选原图能够转换成功base64，一些手机版本勾选原图上传图片就会转换base64失败。这个的原因在于手机系统的targetSDKVersion。<br> 在测试手机中，鸿蒙3勾选原图上传失败，鸿蒙2勾选原图上传成功，magic ui 7上传勾选原图失败。涉及测试机型有华为p40系列，华为meta系列，荣耀magic系列。</p><p>下面附出报错提示：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;bubbles&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cancelBubble&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cancelable&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lengthComputable&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;loaded&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;fileName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/storage/emulated/0/DCIM/Camera/1672501955961.jpg&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;readyState&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
            <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;targetSdkVersion设置&gt;=29后在Android10+系统设备不支持当前路径。请更改为应用运行路径！具体请看:https://ask.dcloud.net.cn/article/36199&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;onloadstart&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;onprogress&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;onload&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;onabort&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;onerror&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function() { [native code] }&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;onloadend&quot;</span><span class="token operator">:</span> <span class="token string">&quot;function() { [native code] }&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用的组件是uview 1.x版本的上传组件，上传时候勾选原图与不勾选原图返回的参数区别：</p><ul><li>不勾选原图</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:///storage/emulated/0/Android/data/io.dcloud.HBuilder/apps/HBuilder/doc/uniapp_temp/compressed/1681887063303_1672501955961.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">109166</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>勾选原图</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:///storage/emulated/0/DCIM/Camera/1672501955961.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">109166</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从以上path的值不仅看出长短的变化，还看到了路径是从哪里开始变化的，即是从<code>file:///storage/emulated/0/</code>后开始变化的。</p>`,10),v={href:"https://www.html5plus.org/doc/zh_cn/io.html",target:"_blank",rel:"noopener noreferrer"},m=n("strong",null,"targetSdkVersion设置>=29后在Android10+系统设备不支持当前路径",-1),b={href:"https://ask.dcloud.net.cn/article/36199",target:"_blank",rel:"noopener noreferrer"},g=n("p",null,"在此链接我们可以知道一些概念：",-1),_=n("ol",null,[n("li",null,"什么是分区存储？为什么要分区存储？哪些系统版本用到了分区存储？"),n("li",null,"什么是系统公共目录？公共目录的路径示例，什么是应用沙盒目录？"),n("li",null,"介绍了哪些方法仅能够访问公共目录、仅能够访问应用沙盒目录、系统公共目录和沙盒目录都能够访问。")],-1),h={href:"https://ask.dcloud.net.cn/article/36199",target:"_blank",rel:"noopener noreferrer"},f=e("<p>公共目录对照表：</p><ul><li>Downloads 对应的绝对路径 <code>file:///storage/emulated/0/Download</code></li><li>Documents 对应的绝对路径 <code>file:///storage/emulated/0/Documents</code></li><li>Pictures 对应的绝对路径 <code>file:///storage/emulated/0/Pictures</code></li><li>DCIM 对应的绝对路径 <code>file:///storage/emulated/0/DCIM</code></li><li>Movies 对应的绝对路径 <code>file:///storage/emulated/0/Movies</code></li><li>Music 对应的绝对路径 <code>file:///storage/emulated/0/Music</code></li><li>Ringtones 对应的绝对路径 <code>file:///storage/emulated/0/Ringtones</code></li></ul><p>应用沙盒目录分为：</p><ul><li>内部存储空间目录 <ul><li>plus.io.PRIVATE_WWW 对应绝对路径 <code>file:///data/user/0/%PACKAGENAME%/files/apps/%APPID%/www</code></li><li>plus.io.PRIVATE_DOC对应绝对路径 <code>file:///data/user/0/%PACKAGENAME%/files/apps/%APPID%/doc</code></li></ul></li><li>外部存储空间目录 <ul><li>plus.io.PUBLIC_DOCUMENTS 对应绝对路径 <code>file:///storage/emulated/0/Android/data/%PACKAGENAME%/.%APPID%/documents</code></li><li>plus.io.PUBLIC_DOWNLOADS 对应绝对路径 <code>file:///storage/emulated/0/Android/data/%PACKAGENAME%/.%APPID%/downloads</code></li></ul></li></ul>",4),q={href:"https://www.html5plus.org/doc/h5p.html",target:"_blank",rel:"noopener noreferrer"},y=n("br",null,null,-1),A=n("img",{src:i,alt:"",loading:"lazy"},null,-1),w=n("p",null,[s("根据以上分析，简单来说，就是勾选原图的时候，访问的是公共目录，而"),n("code",null,"resolveLocalFileSystemURL"),s("这个函数访问不了，不勾选原图的时候，访问的是应用沙盒目录，这时"),n("code",null,"resolveLocalFileSystemURL"),s("才能访问。")],-1),P={href:"https://www.html5plus.org/doc/zh_cn/zip.html#plus.zip.CompressImageOptions",target:"_blank",rel:"noopener noreferrer"},I=n("br",null,null,-1),C=n("code",null,"src",-1),E=n("code",null,"dst",-1),L=n("code",null,"resolveLocalFileSystemURL",-1),R=n("code",null,"plus.zip.CompressImageOptions",-1),j={href:"https://www.html5plus.org/doc/zh_cn/zip.html#plus.zip.CompressImageOptions",target:"_blank",rel:"noopener noreferrer"},S=e(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">pathTobase64</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> pathArr <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    plus<span class="token punctuation">.</span>zip<span class="token punctuation">.</span><span class="token function">compressImage</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">src</span><span class="token operator">:</span> path<span class="token punctuation">,</span>
            <span class="token literal-property property">dst</span><span class="token operator">:</span> <span class="token string">&quot;file:///storage/emulated/0/Android/data/io.dcloud.HBuilder/apps/HBuilder/doc/uniapp_temp/compressed/&quot;</span> <span class="token operator">+</span> pathArr<span class="token punctuation">[</span>pathArr<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">overwrite</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">&quot;jpg&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">quality</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token parameter">success</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//压缩成功</span>
            <span class="token keyword">const</span> compressedPath <span class="token operator">=</span> success<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
             plus<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token function">resolveLocalFileSystemURL</span><span class="token punctuation">(</span>compressedPath<span class="token punctuation">,</span> <span class="token parameter">entry</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                entry<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">plus<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fileReader<span class="token punctuation">.</span><span class="token function-variable function">onloadend</span> <span class="token operator">=</span> <span class="token parameter">evt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//转换成功后的base64</span>
                    <span class="token punctuation">}</span><span class="token punctuation">;</span>
                    fileReader<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fileReader.onerror error: &quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span> <span class="token comment">//转换失败</span>
                    <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;entry.file error: &quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
             <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;plus.io.resolveLocalFileSystemURL error: &quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span>
             <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//压缩失败</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),D=n("br",null,null,-1),z=n("code",null,"file:///storage/emulated/0/Android/data/io.dcloud.HBuilder/",-1),F=n("br",null,null,-1),B=n("code",null,"file:///storage/emulated/0/Android/data/uni.你的appid/",-1),M=n("code",null,"uni.你的appid",-1),x=n("code",null,"io.dcloud.HBuilder",-1),U=n("br",null,null,-1),N={href:"https://uniapp.dcloud.net.cn/tutorial/run/run-app.html#%E5%9F%BA%E5%BA%A7%E9%97%AA%E9%80%80%E8%8E%B7%E5%8F%96%E6%97%A5%E5%BF%97",target:"_blank",rel:"noopener noreferrer"},V=n("p",null,[s("言归正传，所以有些开发者可能就想，那改成"),n("code",null,"file:///storage/emulated/0/Android/data/uni.你的appid/"),s("不就行了吗？答案也是不建议的：")],-1),O=n("li",null,"直接改是可以，但是万一你后面接收的人不知道这个问题的，那就会debug很久才找出这个原因。",-1),T=n("code",null,"uni.你的appid",-1),H=n("code",null,"manifest.json",-1),K=n("br",null,null,-1),G=n("img",{src:u,alt:"",loading:"lazy"},null,-1),W=n("br",null,null,-1),J={href:"https://dev.dcloud.net.cn/pages/common/login",target:"_blank",rel:"noopener noreferrer"},Q=n("p",null,[s("在这里也可以看到appid，所以一般不要在"),n("code",null,"manifest.json"),s("文件里点击重新获取，否则可能app就归到你自己账号名下了。"),n("br"),n("img",{src:r,alt:"",loading:"lazy"})],-1),X={href:"https://www.html5plus.org/doc/zh_cn/io.html#plus.io.requestFileSystem",target:"_blank",rel:"noopener noreferrer"},Y=n("br",null,null,-1),Z=e(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">pathTobase64</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    plus<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token function">requestFileSystem</span><span class="token punctuation">(</span>plus<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token constant">PRIVATE_DOC</span><span class="token punctuation">,</span>
        <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> pathArr <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            plus<span class="token punctuation">.</span>zip<span class="token punctuation">.</span><span class="token function">compressImage</span><span class="token punctuation">(</span>
                <span class="token punctuation">{</span>
                    <span class="token literal-property property">src</span><span class="token operator">:</span> path<span class="token punctuation">,</span>
                    <span class="token literal-property property">dst</span><span class="token operator">:</span> res<span class="token punctuation">.</span>root<span class="token punctuation">.</span>fullPath <span class="token operator">+</span> pathArr<span class="token punctuation">[</span>pathArr<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">overwrite</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">&quot;jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">quality</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token parameter">success</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">//压缩成功</span>
                    <span class="token keyword">const</span> compressedPath <span class="token operator">=</span> success<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
                    plus<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token function">resolveLocalFileSystemURL</span><span class="token punctuation">(</span>compressedPath<span class="token punctuation">,</span> <span class="token parameter">entry</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        entry<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                            <span class="token keyword">let</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">plus<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            fileReader<span class="token punctuation">.</span><span class="token function-variable function">onloadend</span> <span class="token operator">=</span> <span class="token parameter">evt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//转换成功后的base64</span>
                            <span class="token punctuation">}</span><span class="token punctuation">;</span>
                            fileReader<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fileReader.onerror error: &quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span> <span class="token comment">//转换失败</span>
                            <span class="token punctuation">}</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;entry.file error: &quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;plus.io.resolveLocalFileSystemURL error: &quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">//压缩失败</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;plus.io.requestFileSystem error: &quot;</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>至此这个错误就相对完美解决了</p>`,2);function $(nn,sn){const a=o("ExternalLinkIcon");return l(),c("div",null,[k,n("p",null,[s("根据选择完图片后的路径，我们还要借助HTML5+ API的一个函数来帮我们将路径转化为file文件对象。即"),n("a",v,[s("resolveLocalFileSystemURL"),t(a)]),s("：通过URL参数获取目录对象或文件对象。")]),n("p",null,[s("到这里我们再看到上面的报错信息，"),m,s("，后面还跟了一个"),n("a",b,[s("链接"),t(a)]),s("可以打开看看。")]),g,_,n("p",null,[s("具体概念可点击"),n("a",h,[s("链接"),t(a)]),s("查看，这里简单记录一下：")]),f,n("p",null,[s("以及列举了各个方法能够访问的路径：具体可参考"),n("a",q,[s("HTML5+ API文档"),t(a)]),y,A]),w,n("p",null,[s("那又如何解决用户能够勾选原图上传呢？这里我们再参考上面图片列举出的方法，然后选择了"),n("a",P,[s("plus.zip.CompressImageOptions"),t(a)]),s("方法，"),I,s(" 因为它的参数"),C,s("不仅能够访问到系统公共目录，还能够访问应用沙盒目录，而"),E,s("可以将压缩后的图片生成到应用沙盒目录里，这时候"),L,s("函数就可以访问经过"),R,s("函数压缩过后的图片了。")]),n("p",null,[n("a",j,[s("plus.zip.CompressImageOptions"),t(a)]),s("函数使用示例，这里不对它的参数做说明，具体点击前面的链接参考：")]),S,n("p",null,[s("到这里如果你成功了，本地真机测试没问题了，但是如果你一打正式包再测试，那就会出问题了，为什么呢，原因很简单，从上面的方法中也看到，压缩后的输出路径是有问题的，"),D,s(" 本地你再怎么测试，"),z,s("路径下都是没问题的，"),F,s(" 但是你一打包再测试，应用的沙盒路径就不是这个路径了，而是"),B,s("，这里的"),M,s("就是你打包过后的apk包名，而你测试的apk包名都是"),x,s("。"),U,n("a",N,[s("关于apk包名说明链接"),t(a)]),s("，如果你不喜欢打包后的apk报名，你还可以自定义基座，具体的自己研究，要用到Android studio。")]),V,n("ol",null,[O,n("li",null,[s("还有就是apk包名是基于"),T,s("，如果有开发者在打包时候，在"),H,s("文件里不小心点击了重新获取appid，那打包后的路径也是错的。"),K,G,W,s(" 在这里也普及一下，公司开发的app，最好归到公司的账号名下，不要以自己账号来创建应用，你作为协同开发者就行了，与原生微信小程序一样的道理，"),n("a",J,[s("DCloud开发者中心登录"),t(a)]),s("，")])]),Q,n("p",null,[s("所以，压缩后的路径我们就需要动态获取，依靠"),n("a",X,[s("requestFileSystem"),t(a)]),s("函数。"),Y,s(" 修改后的代码：")]),Z])}const en=p(d,[["render",$],["__file","uni-cannot-access-public-path.html.vue"]]);export{en as default};
