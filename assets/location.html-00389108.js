import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as p,c,a as l,b as n,d as s,e as t,f as i}from"./app-af427ef1.js";const u={},r=n("p",null,"location是最有用的DOM对象之一，提供了当前窗口中加载文档的信息，以及通常的导航功能。",-1),d=n("p",null,[s("这个对象的独特的地方在于，它既是window的属性，也是document的属性，即"),n("code",null,"window.location"),s("和"),n("code",null,"document.location"),s("指向同一个对象。location对象不仅保存着当前加载文档的信息，也保存着把URL解析为离散片段后能够通过属性访问信息。")],-1),k={href:"http://foouser:barpassword@www.wrox.com:80/WileyCDA/?q=javascript#contents%EF%BC%8Clocation%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9%E5%A6%82%E4%B8%8B%E8%A1%A8%EF%BC%9A",target:"_blank",rel:"noopener noreferrer"},m=n("thead",null,[n("tr",null,[n("th",{style:{"text-align":"left"}},"属性"),n("th",{style:{"text-align":"left"}},"值"),n("th",{style:{"text-align":"left"}},"说明")])],-1),v=n("tr",null,[n("td",{style:{"text-align":"left"}},"location.hash"),n("td",{style:{"text-align":"left"}},'"#contents"'),n("td",{style:{"text-align":"left"}},"URL 散列值（井号后跟零或多个字符），如果没有则为空字符串")],-1),g=n("td",{style:{"text-align":"left"}},"location.host",-1),h={style:{"text-align":"left"}},b={href:"http://www.wrox.com:80",target:"_blank",rel:"noopener noreferrer"},w=n("td",{style:{"text-align":"left"}},"服务器名及端口号",-1),f=n("td",{style:{"text-align":"left"}},"location.hostname",-1),y={style:{"text-align":"left"}},_={href:"http://www.wrox.com",target:"_blank",rel:"noopener noreferrer"},q=n("td",{style:{"text-align":"left"}},"服务器名",-1),x=n("td",{style:{"text-align":"left"}},"location.href",-1),j={style:{"text-align":"left"}},L={href:"http://www.wrox.com:80/WileyCDA/?q=javascript#contents",target:"_blank",rel:"noopener noreferrer"},R=n("td",{style:{"text-align":"left"}},"当前加载页面的完整 URL。location 的 toString()方法返回这个值",-1),U=n("tr",null,[n("td",{style:{"text-align":"left"}},"location.pathname"),n("td",{style:{"text-align":"left"}},'"/WileyCDA/"'),n("td",{style:{"text-align":"left"}},"URL 中的路径和（或）文件名")],-1),A=n("tr",null,[n("td",{style:{"text-align":"left"}},"location.port"),n("td",{style:{"text-align":"left"}},'"80"'),n("td",{style:{"text-align":"left"}},"请求的端口。如果 URL中没有端口，则返回空字符串")],-1),P=n("tr",null,[n("td",{style:{"text-align":"left"}},"location.protocol"),n("td",{style:{"text-align":"left"}},'"http:"'),n("td",{style:{"text-align":"left"}},'页面使用的协议。通常是"http:"或"https:"')],-1),C=n("tr",null,[n("td",{style:{"text-align":"left"}},"location.search"),n("td",{style:{"text-align":"left"}},'"?q=javascript"'),n("td",{style:{"text-align":"left"}},"URL 的查询字符串。这个字符串以问号开头")],-1),E=n("tr",null,[n("td",{style:{"text-align":"left"}},"location.username"),n("td",{style:{"text-align":"left"}},'"foouser"'),n("td",{style:{"text-align":"left"}},"域名前指定的用户名")],-1),S=n("tr",null,[n("td",{style:{"text-align":"left"}},"location.password"),n("td",{style:{"text-align":"left"}},'"barpassword"'),n("td",{style:{"text-align":"left"}},"域名前指定的密码")],-1),D=n("td",{style:{"text-align":"left"}},"location.origin",-1),B={style:{"text-align":"left"}},W={href:"http://www.wrox.com",target:"_blank",rel:"noopener noreferrer"},I=n("td",{style:{"text-align":"left"}},"URL 的源地址。只读",-1),N=i(`<h2 id="查询字符串" tabindex="-1"><a class="header-anchor" href="#查询字符串" aria-hidden="true">#</a> 查询字符串</h2><p>location 的多数信息都可以通过上面的属性获取。但是 URL 中的查询字符串并不容易使用。虽然location.search 返回了从问号开始直到 URL 末尾的所有内容，但没有办法逐个访问每个查询参数。</p><p>下面代码示例解析查询的字符串，并返回一个以每个查询参数为属性的对象：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token function-variable function">getQueryStringArgs</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 取得没有开头问号的查询字符串</span>
  <span class="token keyword">let</span> qs <span class="token operator">=</span> location<span class="token punctuation">.</span>search<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// 保存数据的对象</span>
    args <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 把每个参数添加到 args 对象</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> qs<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">kv</span> <span class="token operator">=&gt;</span> kv<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      value <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      args<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> args<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getQueryStringArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>URLSearchParams</strong><br> URLSearchParams 提供了一组标准 API 方法，通过它们可以检查和修改查询字符串。给URLSearchParams 构造函数传入一个查询字符串，就可以创建一个实例。这个实例上暴露了 get()、set()和 delete()等方法，可以对查询字符串执行相应操作。下面来看一个例子：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> qs <span class="token operator">=</span> <span class="token string">&quot;?q=javascript&amp;num=10&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> searchParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>qs<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span>searchParams<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot; q=javascript&amp;num=10&quot;</span>
searchParams<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">&quot;num&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;num&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>

searchParams<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>searchParams<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot; q=javascript&amp;num=10&amp;page=3&quot;</span>

searchParams<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;q&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>searchParams<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot; num=10&amp;page=3&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>大多数支持 URLSearchParams 的浏览器也支持将 URLSearchParams 的实例用作可迭代对象：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> qs <span class="token operator">=</span> <span class="token string">&quot;?q=javascript&amp;num=10&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> searchParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>qs<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> param <span class="token keyword">of</span> searchParams<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// [&quot;q&quot;, &quot;javascript&quot;]</span>
<span class="token comment">// [&quot;num&quot;, &quot;10&quot;] </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="操作地址" tabindex="-1"><a class="header-anchor" href="#操作地址" aria-hidden="true">#</a> 操作地址</h2><p>可以通过修改 location 对象修改浏览器的地址。首先，最常见的是使用 assign()方法并传入一个 URL，如下所示：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>location<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.wrox.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这行代码会立即启动导航到新 URL 的操作，同时在浏览器历史记录中增加一条记录。如果给location.href 或 window.location 设置一个 URL，也会以同一个 URL 值调用 assign()方法。比如，下面两行代码都会执行与显式调用 assign()一样的操作：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token string">&quot;http://www.wrox.com&quot;</span><span class="token punctuation">;</span>
location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;http://www.wrox.com&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>在这 3 种修改浏览器地址的方法中，设置 location.href 是最常见的。<br> 修改 location 对象的属性也会修改当前加载的页面。其中，hash、search、hostname、pathname和 port 属性被设置为新值之后都会修改当前 URL，如下面的例子所示：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 假设当前 URL 为 http://www.wrox.com/WileyCDA/</span>

<span class="token comment">// 把 URL 修改为 http://www.wrox.com/WileyCDA/#section1</span>
location<span class="token punctuation">.</span>hash <span class="token operator">=</span> <span class="token string">&quot;#section1&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 把 URL 修改为 http://www.wrox.com/WileyCDA/?q=javascript</span>
location<span class="token punctuation">.</span>search <span class="token operator">=</span> <span class="token string">&quot;?q=javascript&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 把 URL 修改为 http://www.somewhere.com/WileyCDA/</span>
location<span class="token punctuation">.</span>hostname <span class="token operator">=</span> <span class="token string">&quot;www.somewhere.com&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 把 URL 修改为 http://www.somewhere.com/mydir/</span>
location<span class="token punctuation">.</span>pathname <span class="token operator">=</span> <span class="token string">&quot;mydir&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 把 URL 修改为 http://www.somewhere.com:8080/WileyCDA/</span>
location<span class="token punctuation">.</span>port <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除了 hash 之外，只要修改 location 的一个属性，就会导致页面重新加载新 URL。</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>修改 hash 的值会在浏览器历史中增加一条新记录。在早期的 IE 中，点击“后退”和“前进”按钮不会更新 hash 属性，只有点击包含散列的 URL 才会更新 hash 的值。</p></div><p>在上面提到的方式修改URL之后，浏览器历史记录中会增加相应的记录。但当用户单击“后退”按钮时，会导航到前一个页面。如果不希望增加历史记录，可以使用replace()方法。这个方法同样接收一个url参数。但加载后不会增加历史记录。如下所示。当调用replace()之后，页面跳转到新页面，此时用户无法回到前一页，因为无历史记录：</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>You won&#39;t be able to get back here<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Enjoy this page for a second, because you won&#39;t be coming back here.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
 <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.wrox.com/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后一个修改地址方法是reload()，它能重新加载当前显示的页面。使用如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 重新加载，可能是从缓存加载</span>
location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 重新加载，从服务器加载</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>脚本中位于 reload()调用之后的代码可能执行也可能不执行，这取决于网络延迟和系统资源等因素。为此，最好把 reload()作为最后一行代码。</p>`,22);function V(F,T){const a=o("ExternalLinkIcon");return p(),c("div",null,[r,l(" more "),d,n("p",null,[s("假设浏览器当前加载的 URL 是 "),n("a",k,[s("http://foouser:barpassword@www.wrox.com:80/WileyCDA/?q=javascript#contents，location对象的内容如下表："),t(a)])]),n("table",null,[m,n("tbody",null,[v,n("tr",null,[g,n("td",h,[s('"'),n("a",b,[s("www.wrox.com:80"),t(a)]),s('"')]),w]),n("tr",null,[f,n("td",y,[s('"'),n("a",_,[s("www.wrox.com"),t(a)]),s('"')]),q]),n("tr",null,[x,n("td",j,[s('"'),n("a",L,[s("http://www.wrox.com:80/WileyCDA/?q=javascript#contents"),t(a)]),s('"')]),R]),U,A,P,C,E,S,n("tr",null,[D,n("td",B,[s('"'),n("a",W,[s("http://www.wrox.com"),t(a)]),s('"')]),I])])]),N])}const Y=e(u,[["render",V],["__file","location.html.vue"]]);export{Y as default};
